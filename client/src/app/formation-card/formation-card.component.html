<section class="bg-gradient-to-br from-gray-50 to-indigo-50 py-16">
  <div class="container mx-auto px-6">
    <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
      <div
        *ngFor="let detail of filteredDetails"
        class="group relative overflow-hidden rounded-2xl bg-white shadow-lg transition-all duration-300"
      >
        <!-- Background Gradient Overlay - Card hover only -->
        <div class="absolute inset-0 bg-gradient-to-br from-indigo-600/5 to-purple-600/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>

        <!-- Badges Container -->
        <div class="absolute top-4 left-4 right-4 flex justify-between items-start z-10">
          <!-- Type Badge -->
          <span
            *ngIf="detail.type_formation === 'Gratuit'"
            class="inline-flex items-center px-3 py-1.5 rounded-full bg-emerald-500 text-white text-xs font-semibold shadow-lg backdrop-blur-sm"
          >
            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"/>
            </svg>
            Gratuit
          </span>

          <span
            *ngIf="detail.type_formation === 'Payant'"
            class="inline-flex items-center px-3 py-1.5 rounded-full bg-gradient-to-r from-yellow-500 to-orange-500 text-white text-xs font-semibold shadow-lg backdrop-blur-sm"
          >
            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"/>
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd"/>
            </svg>
            Premium
          </span>

          <!-- Status Badge -->
          <span
            [ngClass]="{
              'bg-emerald-500': detail.etat === 'En cours',
              'bg-amber-500': detail.etat === 'Annoncé',
              'bg-gradient-to-r from-red-500 to-rose-500': detail.etat === 'Terminé'
            }"
            class="inline-flex items-center px-3 py-1.5 rounded-full text-white text-xs font-semibold shadow-lg backdrop-blur-sm"
          >
            <div
              [ngClass]="{
                'bg-green-200': detail.etat === 'En cours',
                'bg-orange-500': detail.etat === 'Annoncé',
                'bg-red-200': detail.etat === 'Terminé'
              }"
              class="w-2 h-2 rounded-full mr-2 animate-pulse"
            ></div>
            {{ detail.etat }}
          </span>
        </div>

        <!-- Training Image with Overlay -->
        <div class="relative h-52 overflow-hidden">
          <img
            *ngIf="detail?.image || 'assets/images/default.png'"
            [src]="detail.image"
            [alt]="detail.theme_formation"
            class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
          />
          <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          
          <!-- Floating Mode Indicator -->
          <div class="absolute bottom-4 left-4 right-4">
            <div class="inline-flex items-center px-3 py-2 rounded-lg bg-white/90 backdrop-blur-md text-gray-800 text-sm font-medium shadow-lg">
              <svg 
                *ngIf="detail.mode_formation === 'Présentiel'"
                class="w-4 h-4 mr-2 text-indigo-600" 
                fill="currentColor" 
                viewBox="0 0 20 20"
              >
                <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
              </svg>
              <svg 
                *ngIf="detail.mode_formation === 'En ligne'"
                class="w-4 h-4 mr-2 text-indigo-600" 
                fill="currentColor" 
                viewBox="0 0 20 20"
              >
                <path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"/>
              </svg>
              {{ detail.mode_formation }}
            </div>
          </div>
        </div>

        <!-- Card Content -->
        <div class="p-6 relative z-10">
          <!-- Title with Gradient -->
          <h2 class="text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-4 line-clamp-2">
            {{ detail.theme_formation }}
          </h2>

          <!-- Details Grid -->
          <div class="space-y-3">
            <!-- Formateur -->
            <div class="flex items-center text-sm">
              <div class="w-8 h-8 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                <svg class="w-4 h-4 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                </svg>
              </div>
              <div>
                <span class="text-gray-500 text-xs">Formateur</span>
                <p class="font-medium text-gray-800">{{ detail.formateur?.nom_et_prenom || "Non défini" }}</p>
              </div>
            </div>

            <!-- Salle (if Présentiel) -->
            <div *ngIf="detail.mode_formation === 'Présentiel'" class="flex items-center text-sm">
              <div class="w-8 h-8 bg-gradient-to-br from-green-100 to-emerald-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                <svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm3 7a1 1 0 100-2 1 1 0 000 2zm6-1a1 1 0 11-2 0 1 1 0 012 0zm-3 4a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                </svg>
              </div>
              <div>
                <span class="text-gray-500 text-xs">Salle</span>
                <p class="font-medium text-gray-800">{{ detail.num_salle }}</p>
              </div>
            </div>

            <!-- Période -->
            <div  *ngIf="detail.mode_formation === 'Présentiel'" class="flex items-center text-sm">
              <div class="w-8 h-8 bg-gradient-to-br from-blue-100 to-cyan-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                </svg>
              </div>
              <div>
                <span class="text-gray-500 text-xs">Période</span>
                <p class="font-medium text-gray-800 text-xs">
                  {{ detail.date_debut | date : "dd/MM/yyyy" }} - {{ detail.date_fin | date : "dd/MM/yyyy" }}
                </p>
              </div>
            </div>

            <!-- Horaire (if Présentiel) -->
            <div *ngIf="detail.mode_formation === 'Présentiel'" class="flex items-center text-sm">
              <div class="w-8 h-8 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                <svg class="w-4 h-4 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
                </svg>
              </div>
              <div>
                <span class="text-gray-500 text-xs">Horaire</span>
                <p class="font-medium text-gray-800">{{ detail.horaire_debut }} - {{ detail.horaire_fin }}</p>
              </div>
            </div>
          </div>

          <!-- Action Buttons - Independent hover effects -->
          <div class="mt-6 space-y-2">
            <!-- Register Button -->
            <button
              *ngIf="!isRegistered(detail._id) && detail.mode_formation === 'Présentiel'"
              type="button"
              [disabled]="detail.etat === 'Terminé'"
              (click)="onRegister(detail._id)"
              class="btn-register w-full relative overflow-hidden rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-3 text-sm font-semibold text-white shadow-lg transition-all duration-300"
              [ngClass]="{
                'bg-gradient-to-r from-indigo-600 to-purple-600 hover:shadow-xl hover:scale-[1.02]': detail.etat !== 'Terminé',
                'bg-gray-400 cursor-not-allowed': detail.etat === 'Terminé'
              }"
            >
              <span class="relative z-10 flex items-center justify-center">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                </svg>
                S'inscrire
              </span>
              <div class="absolute inset-0 bg-gradient-to-r from-purple-600 to-indigo-600 opacity-0 btn-register-hover:opacity-100 transition-opacity duration-300"></div>
            </button>

            <!-- Consult Formation Button -->
            <a
              *ngIf="detail.mode_formation === 'En ligne'"
              [routerLink]="['/nosformation/formation', detail._id]"
              class="btn-consult block w-full relative overflow-hidden rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-3 text-sm font-semibold text-white shadow-lg transition-all duration-300 text-center"
            >
              <span class="relative z-10 flex items-center justify-center">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                  <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                </svg>
                Consulter Formation
              </span>
              <div class="absolute inset-0 bg-gradient-to-r from-purple-600 to-indigo-600 opacity-0 btn-consult-hover:opacity-100 transition-opacity duration-300"></div>
            </a>

            <!-- Noter Button -->
            <button
              *ngIf="isRegistered(detail._id) && detail.mode_formation === 'Présentiel'"
              type="button"
              [disabled]="detail.etat !== 'Terminé'"
              (click)="openNoteModal(detail._id)"
              class="btn-rate w-full relative overflow-hidden rounded-xl px-6 py-3 text-sm font-semibold text-white shadow-lg transition-all duration-300"
              [ngClass]="{
                'bg-gradient-to-r from-green-600 to-emerald-600 hover:shadow-xl hover:scale-[1.02]': detail.etat === 'Terminé',
                'bg-gray-400 cursor-not-allowed': detail.etat !== 'Terminé'
              }"
            >
              <span class="relative z-10 flex items-center justify-center">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>
                Noter
              </span>
              <div 
                *ngIf="detail.etat === 'Terminé'"
                class="absolute inset-0 bg-gradient-to-r from-emerald-600 to-green-600 opacity-0 btn-rate-hover:opacity-100 transition-opacity duration-300"
              ></div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Guest Registration Modal -->
<div 
  *ngIf="showGuestModal" 
  class="fixed inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm z-50 p-4"
  (click)="closeGuestModal()"
>
  <div 
    class="bg-white rounded-2xl shadow-xl w-full max-w-md"
    (click)="$event.stopPropagation()"
  >
    <!-- Modal Header -->
    <div class="px-6 py-4 border-b border-slate-200">
      <h3 class="text-xl font-semibold text-slate-800">S'inscrire à la Formation</h3>
      <p class="text-sm text-slate-500">Veuillez entrer vos informations.</p>
    </div>

    <!-- Modal Body -->
    <div class="p-6">
      <form (ngSubmit)="submitGuestRegistration()">
        <div class="space-y-4">
          <div>
            <label for="guestName" class="block text-sm font-medium text-slate-700 mb-1">Nom complet</label>
            <input 
              type="text" 
              id="guestName" 
              [(ngModel)]="guestData.name"
              name="guestName"
              class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
              placeholder="Ex: Jean Dupont"
              required
            >
          </div>
          <div>
            <label for="guestEmail" class="block text-sm font-medium text-slate-700 mb-1">Adresse Email</label>
            <input 
              type="email" 
              id="guestEmail" 
              [(ngModel)]="guestData.email"
              name="guestEmail"
              class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
              placeholder="Ex: jean.dupont@email.com"
              required
            >
          </div>
          <div *ngIf="guestFormError" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-3 rounded-md text-sm">
            {{ guestFormError }}
          </div>
        </div>

        <!-- Modal Footer -->
        <div class="mt-6 flex justify-end space-x-3">
          <button 
            type="button" 
            (click)="closeGuestModal()"
            class="px-5 py-2.5 text-sm font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg"
          >
            Annuler
          </button>
          <button 
            type="submit"
            [disabled]="isSubmittingGuest"
            class="px-5 py-2.5 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg disabled:bg-indigo-300 disabled:cursor-not-allowed flex items-center justify-center"
          >
            <span *ngIf="!isSubmittingGuest">S'inscrire</span>
            <span *ngIf="isSubmittingGuest">
              <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>


<!-- Toast Notification -->
<div 
  *ngIf="showToast" 
  @fadeInOut
  class="fixed top-5 right-5 z-[100] p-4 rounded-lg shadow-lg text-white"
  [ngClass]="{
    'bg-emerald-500': toastType === 'success',
    'bg-red-500': toastType === 'error'
  }"
>
  {{ toastMessage }}
</div>
<!-- Modal for Note Submission -->
<div
  *ngIf="showNoteModal"
  class="fixed inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm z-50 p-4"
  (click)="closeNoteModal()"
>
  <div 
    class="bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/20 w-full max-w-5xl max-h-[90vh] overflow-hidden"
    (click)="$event.stopPropagation()"
  >
    <!-- Modal Header -->
    <div class="bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-700 px-8 py-6">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-2xl font-bold text-white mb-1">Évaluation de la Formation</h2>
          <p class="text-indigo-100 text-sm">Partagez votre expérience pour nous aider à améliorer nos services</p>
        </div>
        <button
          type="button"
          (click)="closeNoteModal()"
          class="text-white hover:text-indigo-200 transition-colors p-2 rounded-full hover:bg-white/10"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Modal Content -->
    <div class="p-8 overflow-y-auto max-h-[calc(90vh-120px)]">
      <form (ngSubmit)="submitNote()" #noteForm="ngForm">
        <!-- Rating Table -->
        <div class="bg-white rounded-2xl shadow-lg border border-slate-200/50 overflow-hidden mb-8">
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead>
                <tr class="bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200">
                  <th class="text-left p-6 font-semibold text-slate-800 min-w-[250px]">Critères d'Évaluation</th>
                  <th class="text-center p-6 font-semibold text-slate-800 min-w-[120px]">
                    <div class="flex flex-col items-center">
                      <span class="text-emerald-600 text-lg">★★★★★</span>
                      <span class="text-xs text-slate-600 mt-1">Excellent (5)</span>
                    </div>
                  </th>
                  <th class="text-center p-6 font-semibold text-slate-800 min-w-[120px]">
                    <div class="flex flex-col items-center">
                      <span class="text-blue-500 text-lg">★★★★</span>
                      <span class="text-xs text-slate-600 mt-1">Bien (4)</span>
                    </div>
                  </th>
                  <th class="text-center p-6 font-semibold text-slate-800 min-w-[120px]">
                    <div class="flex flex-col items-center">
                      <span class="text-amber-500 text-lg">★★★</span>
                      <span class="text-xs text-slate-600 mt-1">Moyen (3)</span>
                    </div>
                  </th>
                  <th class="text-center p-6 font-semibold text-slate-800 min-w-[120px]">
                    <div class="flex flex-col items-center">
                      <span class="text-red-500 text-lg">✗</span>
                      <span class="text-xs text-slate-600 mt-1">Insatisfaisant (0)</span>
                    </div>
                  </th>
                </tr>
              </thead>
              <tbody class="divide-y divide-slate-100">
                <!-- Row 1: Environnement -->
                <tr class="hover:bg-slate-50/50 transition-colors">
                  <td class="p-6">
                    <div class="flex items-center">
                      <div class="w-10 h-10 bg-gradient-to-br from-green-100 to-emerald-100 rounded-xl flex items-center justify-center mr-4">
                        <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm3 7a1 1 0 100-2 1 1 0 000 2zm6-1a1 1 0 11-2 0 1 1 0 012 0zm-3 4a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                        </svg>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Évaluation de l'environnement</h4>
                        <p class="text-sm text-slate-600">Locaux, équipements, conditions d'apprentissage</p>
                      </div>
                    </div>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note1" name="note1" value="5" id="note1-5" class="hidden peer/5" required>
                    <label for="note1-5" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-emerald-400 peer-checked/5:border-emerald-500 peer-checked/5:bg-emerald-500 peer-checked/5:text-white transition-all duration-200 text-emerald-600 font-bold hover:scale-105">5</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note1" name="note1" value="4" id="note1-4" class="hidden peer/4">
                    <label for="note1-4" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-blue-400 peer-checked/4:border-blue-500 peer-checked/4:bg-blue-500 peer-checked/4:text-white transition-all duration-200 text-blue-600 font-bold hover:scale-105">4</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note1" name="note1" value="3" id="note1-3" class="hidden peer/3">
                    <label for="note1-3" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-amber-400 peer-checked/3:border-amber-500 peer-checked/3:bg-amber-500 peer-checked/3:text-white transition-all duration-200 text-amber-600 font-bold hover:scale-105">3</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note1" name="note1" value="0" id="note1-0" class="hidden peer/0">
                    <label for="note1-0" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-red-400 peer-checked/0:border-red-500 peer-checked/0:bg-red-500 peer-checked/0:text-white transition-all duration-200 text-red-600 font-bold hover:scale-105">0 </label>
                  </td>
                </tr>

                <!-- Row 2: Contenu -->
                <tr class="hover:bg-slate-50/50 transition-colors">
                  <td class="p-6">
                    <div class="flex items-center">
                      <div class="w-10 h-10 bg-gradient-to-br from-blue-100 to-cyan-100 rounded-xl flex items-center justify-center mr-4">
                        <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                          <path d="M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V12a1 1 0 11-2 0V4.804z"/>
                        </svg>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Évaluation du contenu</h4>
                        <p class="text-sm text-slate-600">Qualité, pertinence, actualité du programme</p>
                      </div>
                    </div>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note2" name="note2" value="5" id="note2-5" class="hidden peer/5" required>
                    <label for="note2-5" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-emerald-400 peer-checked/5:border-emerald-500 peer-checked/5:bg-emerald-500 peer-checked/5:text-white transition-all duration-200 text-emerald-600 font-bold hover:scale-105">5</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note2" name="note2" value="4" id="note2-4" class="hidden peer/4">
                    <label for="note2-4" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-blue-400 peer-checked/4:border-blue-500 peer-checked/4:bg-blue-500 peer-checked/4:text-white transition-all duration-200 text-blue-600 font-bold hover:scale-105">4</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note2" name="note2" value="3" id="note2-3" class="hidden peer/3">
                    <label for="note2-3" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-amber-400 peer-checked/3:border-amber-500 peer-checked/3:bg-amber-500 peer-checked/3:text-white transition-all duration-200 text-amber-600 font-bold hover:scale-105">3</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note2" name="note2" value="0" id="note2-0" class="hidden peer/0">
                    <label for="note2-0" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-red-400 peer-checked/0:border-red-500 peer-checked/0:bg-red-500 peer-checked/0:text-white transition-all duration-200 text-red-600 font-bold hover:scale-105">0</label>
                  </td>
                </tr>

                <!-- Row 3: Formateur -->
                <tr class="hover:bg-slate-50/50 transition-colors">
                  <td class="p-6">
                    <div class="flex items-center">
                      <div class="w-10 h-10 bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl flex items-center justify-center mr-4">
                        <svg class="w-5 h-5 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                        </svg>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Évaluation du formateur</h4>
                        <p class="text-sm text-slate-600">Pédagogie, expertise, interaction</p>
                      </div>
                    </div>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note3" name="note3" value="5" id="note3-5" class="hidden peer/5" required>
                    <label for="note3-5" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-emerald-400 peer-checked/5:border-emerald-500 peer-checked/5:bg-emerald-500 peer-checked/5:text-white transition-all duration-200 text-emerald-600 font-bold hover:scale-105">5</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note3" name="note3" value="4" id="note3-4" class="hidden peer/4">
                    <label for="note3-4" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-blue-400 peer-checked/4:border-blue-500 peer-checked/4:bg-blue-500 peer-checked/4:text-white transition-all duration-200 text-blue-600 font-bold hover:scale-105">4</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note3" name="note3" value="3" id="note3-3" class="hidden peer/3">
                    <label for="note3-3" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-amber-400 peer-checked/3:border-amber-500 peer-checked/3:bg-amber-500 peer-checked/3:text-white transition-all duration-200 text-amber-600 font-bold hover:scale-105">3</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note3" name="note3" value="0" id="note3-0" class="hidden peer/0">
                    <label for="note3-0" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-red-400 peer-checked/0:border-red-500 peer-checked/0:bg-red-500 peer-checked/0:text-white transition-all duration-200 text-red-600 font-bold hover:scale-105">0</label>
                  </td>
                </tr>

                <!-- Row 4: Organisation -->
                <tr class="hover:bg-slate-50/50 transition-colors">
                  <td class="p-6">
                    <div class="flex items-center">
                      <div class="w-10 h-10 bg-gradient-to-br from-amber-100 to-orange-100 rounded-xl flex items-center justify-center mr-4">
                        <svg class="w-5 h-5 text-amber-600" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                        </svg>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Évaluation de l'organisation</h4>
                        <p class="text-sm text-slate-600">Planning, communication, supports</p>
                      </div>
                    </div>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note4" name="note4" value="5" id="note4-5" class="hidden peer/5" required>
                    <label for="note4-5" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-emerald-400 peer-checked/5:border-emerald-500 peer-checked/5:bg-emerald-500 peer-checked/5:text-white transition-all duration-200 text-emerald-600 font-bold hover:scale-105">5</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note4" name="note4" value="4" id="note4-4" class="hidden peer/4">
                    <label for="note4-4" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-blue-400 peer-checked/4:border-blue-500 peer-checked/4:bg-blue-500 peer-checked/4:text-white transition-all duration-200 text-blue-600 font-bold hover:scale-105">4</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note4" name="note4" value="3" id="note4-3" class="hidden peer/3">
                    <label for="note4-3" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-amber-400 peer-checked/3:border-amber-500 peer-checked/3:bg-amber-500 peer-checked/3:text-white transition-all duration-200 text-amber-600 font-bold hover:scale-105">3</label>
                  </td>
                  <td class="text-center p-6">
                    <input type="radio" [(ngModel)]="noteData.note4" name="note4" value="0" id="note4-0" class="hidden peer/0">
                    <label for="note4-0" class="cursor-pointer inline-flex items-center justify-center w-12 h-12 rounded-xl border-2 border-slate-200 hover:border-red-400 peer-checked/0:border-red-500 peer-checked/0:bg-red-500 peer-checked/0:text-white transition-all duration-200 text-red-600 font-bold hover:scale-105">0</label>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Comment Section -->
        <div class="bg-white rounded-2xl shadow-lg border border-slate-200/50 p-8 mb-8">
          <div class="flex items-center mb-6">
            <div class="w-12 h-12 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-xl flex items-center justify-center mr-4">
              <svg class="w-6 h-6 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/>
              </svg>
            </div>
            <div>
              <h3 class="text-xl font-bold text-slate-800">Commentaires et Suggestions</h3>
              <p class="text-sm text-slate-600">Partagez vos impressions détaillées (optionnel)</p>
            </div>
          </div>
          
          <textarea
            [(ngModel)]="noteData.commentaire"
            name="commentaire"
            rows="6"
            placeholder="Décrivez votre expérience, ce qui vous a plu, vos suggestions d'amélioration..."
            class="w-full px-6 py-4 border border-slate-200 rounded-2xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none text-slate-700 placeholder-slate-400 bg-slate-50/50 hover:bg-white transition-all duration-200"
          ></textarea>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-end">
          <button
            type="button"
            (click)="closeNoteModal()"
            class="group px-8 py-4 bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold rounded-2xl transition-all duration-200 hover:scale-105 border border-slate-200"
          >
            <span class="flex items-center justify-center">
              <svg class="w-4 h-4 mr-2 transition-transform group-hover:-translate-x-1" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/>
              </svg>
              Annuler
            </span>
          </button>
          
          <button
            type="submit"
            [disabled]="!noteForm.valid"
            class="group relative overflow-hidden px-8 py-4 bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-700 text-white font-semibold rounded-2xl shadow-lg transition-all duration-300 hover:shadow-xl hover:shadow-indigo-500/25 hover:scale-105 border border-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100"
          >
            <span class="relative z-10 flex items-center justify-center">
              <svg class="w-4 h-4 mr-2 transition-transform group-hover:rotate-12" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
              </svg>
              Soumettre l'Évaluation
            </span>
            <div class="absolute inset-0 bg-gradient-to-r from-purple-600 via-indigo-600 to-purple-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
